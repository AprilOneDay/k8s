kubectl get pod --all-namespaces -o wide 
kubectl get service -n kube-system
kubectl get nodes
kubectl get cs

# 更新token
kubeadm token create openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2>/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //'

#执行
kubeadm join --token 5fj5y2.0cl5d5y09sjqu3hu 192.168.20.236:6443
#错误
discovery.bootstrapToken: Invalid value: "": using token-based discovery without caCertHashes can be unsafe. Set unsafeSkipCAVerification to continue
#解决 忽略错误
kubeadm join --token 5fj5y2.0cl5d5y09sjqu3hu 192.168.20.236:6443 --discovery-token-unsafe-skip-ca-verification

#安装dashboard
kubectl create -f /k8s/dashboard/kubernetes-dashboard.yaml
##生成令牌
kubectl create serviceaccount dashboard-admin -n kube-system
kubectl create clusterrolebinding dashboard-admin --clusterrole=cluster-admin --serviceaccount=kube-system:dashboard-admin
kubectl describe secrets -n kube-system $(kubectl -n kube-system get secret | awk '/dashboard-admin/{print $1}')

eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tZ2tkemciLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNmM0ODA0NWQtZGFiOS0xMWU5LWI4NmEtMDgwMDI3M2UxNTVmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhc2hib2FyZC1hZG1pbiJ9.T0M5jbyt_XhPCoHgjGxr-4eGchVUxwUH5jvzA80tw5bSriSu38uaqohuNlPwMzpNZfrTqzqTomfu38nqBq-0feAz0LmgK71pVAlGjWcuVb9m-TL43QyLkg0QO9Dx053jGUvkNgOJfVmmNIBSVHPYbjb74pFs0SkJ9XRgJvrCunlDZ_DcK99OpuezwUoW4xE4uw6c4FjFG9xWbCEnCsz8RaSx7Y3RYOM_UFBIMcS3buWkQOWMvQGVh5h411ccWQVNE_Ccjuiu0ENMyfgzdnHuTrt8xUGddhmlqmlW-To5J_7aHkXe4l4t5c7uYMQJwSO46euSFfuxz67h3kegS7AsDw

mkdir key && cd key
#生成证书
openssl genrsa -out dashboard.key 2048 
openssl req -new -out dashboard.csr -key dashboard.key -subj '/CN=192.168.20.236'
openssl x509 -req -in dashboard.csr -signkey dashboard.key -out dashboard.crt
#删除原有的证书secret
kubectl delete secret kubernetes-dashboard-certs -n kube-system
#创建新的证书secret
kubectl create secret generic kubernetes-dashboard-certs --from-file=dashboard.key --from-file=dashboard.crt -n kube-system
#查看pod
kubectl get pod -n kube-system
#重启pod
kubectl delete pod <pod name> -n kube-system 

kubectl delete pod kubernetes-dashboard-7d77666777-zgnnq -n kube-system 

#修改配置文件
vi /etc/sysconfig/network-scripts/ifcfg-enp0s3
TYPE="Ethernet"
BOOTPROTO="static" #静态方式 dhcp
NM_CONTROLLED="no" #不使用网络管理器
 
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="enp0s3"
UUID="2b4bcec5-6c11-411b-b7b5-177d6b1075b2"
DEVICE="enp0s3"
ONBOOT="yes"
 
IPADDR=192.168.0.110 #设置固定ip
NETMASK=255.255.255.0 #子网掩码为物理机子网掩码(subnet mask)
GATEWAY=192.168.0.1 #设置网关为物理机网关(gateway)

#重启网卡
>service network restart

#添加DNS服务器
vi /etc/resolv.conf
# Generated by NetworkManager
search localdomain
nameserver 114.114.114.114 #114DNS
nameserver 114.114.114.115
